## Что такое чистые функции?
***Чистые функции*** или ***pure functions*** — это функции, которые при вызове не влияют на состояние программы (детерминированные функции) и не имеют побочных эффектов. Они возвращают значения только на основе входных аргументов и не изменяют их.

Теперь разберемся, что такое **детерминированность** и **побочные функции**
### Что такое детерминированность?
**Детерминированность функций** — это свойство, при котором функция всегда возвращает один и тот же результат для одних и тех же входных данных. Детерминированная функция **не зависит от контекста и внешних факторов**. Она гарантированно возвращает предсказуемый результат.

```
def summa(a, b):
	return a + b
```
Функция summa при передаче одних и тех же аргументов выведет те же самые значения:
```
print(summa(2,3))
#5
print(summa(2,3))
#5
print(summa(2,3))
#5
```

Теперь рассмотрим функцию, которая не является детерминированной:
```
import random
def random_number():
	return random.randint(1,10)
```
Эта функция возвращает случайное число от 1 до 10 при каждом вызове. Если мы вызываем функцию несколько раз, то получим разные результаты:

```
print(random_number())
# 3
print(random_number())
# 7
print(random_number())
# 1
```
Недетерминированной функцией ее делает вывод разных значений при вызове одной и той же функции.

### Что такое побочный эффект?
**Побочный эффект** или **side effects** — это любые взаимодействия с внешней средой. К ним относятся файловые операции, такие как запись в файл, чтение файла, отправка или приём данных по сети и даже вывод в консоль.
```
def print_hello():
    print("Hello, world!")
```
Эта функция имеет побочный эффект, поскольку выводит сообщение в консоль.

Побочные эффекты составляют одну из самых больших сложностей при разработке. Они затрудняют логику кода и тестирование. Это приводит к большому числу ошибок. Например, только при работе с файлами количество возможных ошибок измеряется сотней. В этом случае может не хватить места на диске или будет попытка прочитать данные из несуществующего файла. Для предотвращения ошибок код обрастает большим числом проверок и защитных механизмов.

Но без побочных эффектов невозможно написать ни одной программы. Какие бы вычисления она ни делала, их результат должен быть как-то продемонстрирован. Даже у простой программы сложения двух чисел нам нужно увидеть результат, что автоматически приводит к побочным эффектам. В реальных же приложениях, обычно, все сводится к взаимодействию с базой данных или отправкой запросов по сети. Не существует способа избавиться от побочных эффектов совсем, но их влияние на программу можно минимизировать.

**У чистых функций есть несколько преимуществ:**

- Их просто тестировать. Достаточно передать на вход функции нужные параметры и посмотреть ожидаемый выход.
- Их безопасно запускать повторно, что особенно актуально в асинхронном коде или в случае многопоточного кода.
- Их легко комбинировать, получая новое поведение без необходимости переписывать программу.

### Признаки чистых функций:
- Всегда возвращают одинаковые значения для одинаковых аргументов.
- Не имеют побочных эффектов — не изменяют состояние программы за пределами своей области видимости. Таким образом они не используют глобальные переменные, не изменяют содержимое файлов, не выводят на экран и не изменяют содержимое баз данных.
- Не имеют побочных эффектов на аргументы, которые переданы им по ссылке — не изменяют их содержимое.
- Не зависят от состояния программы, поэтому не используют глобальные переменные или переменные, которые могут изменяться во время выполнения программы.

### Примеры чистых функций
#### Функция, которая возвращает квадрат числа

Эта функция принимает число и возвращает его квадрат. Она не изменяет внешние переменные и всегда даёт одинаковый результат для одних и тех же входных данных.

```
def square(x):
    return x * x
```

#### Функция, которая возвращает сумму элементов списка

Эта функция складывает все элементы списка и возвращает результат. Она также чистая, поскольку не изменяет внешние данные.

```
def sum_list(lst): 
	return sum(lst)
```

#### Функция, которая объединяет два списка

Эта функция принимает два списка и возвращает новый список, состоящий из элементов первого и второго списка. Она не изменяет исходные списки.

```
def concatenate_lists(lst1, lst2):
	return lst1 + lst2
```

Все эти функции соответствуют критериям чистых функций: они не изменяют внешнее состояние программы и всегда возвращают один и тот же результат при одинаковых входных данных.

## Грязные функции
Не все функции могут быть чистыми, особенно, когда программы часто взаимодействуют с внешними ресурсами. В таких случаях функции могут изменять состояние программы или взаимодействовать с внешними системами, такими как базы данных или веб-сервисы. Такие функции называют грязными.

Один из интересных примеров это ***замыкание***. Само по себе замыкание не делает функцию ни чистой, ни грязной. Все зависит от того, возможно ли изменять замкнутую переменную.

Если замыкание только читает замкнутые переменные, не изменяя их, функция остается чистой:

```
def outer(x):
    def inner(y):
        return x + y
    return inner

add_5 = outer(5)
print(add_5(10)) # => 15
#чистая функция
```

Если замыкание изменяет замкнутые переменные, функция становится грязной - нарушается требование детерминированности:

```
def outer():
    count = 0
    def inner():
        nonlocal count
        count += 1
        return count
    return inner

counter = outer()
print(counter()) # => 1
print(counter()) # => 2
```

Если замыкание использует изменяемые объекты, функция тоже может быть грязной - возникает побочный эффект:

```python
def outer(lst):
    def inner(item):
        lst.append(item)
        return lst
    return inner

add_to_list = outer([])
print(add_to_list(1)) # => [1]
print(add_to_list(2)) # => [1, 2]
```