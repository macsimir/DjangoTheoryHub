### Определение 
Чистая, элегантная схема URL-адресов — важная деталь в высококачественном веб-приложении. Django позволяет создавать URL-адреса так, как вы хотите, без ограничений фреймворка.

### Функция path
За сопоставление путей и функций-представлений отвечает функция `path()`, которая располагается в пакете `django.urls` и она принимает четыре параметра:

```python
path(route, view, kwargs=None, name=None)
```
1. **`route`**: представляет шаблон адреса URL, которому должен соответствовать запрос
2. **`view`**: функция-представление, которое обрабатывает запрос
3. **`kwargs`**: дополнительные аргументы, которые передаются в функцию-представление
5. **`name`**: название маршрута.Позволяет задать идентификатор для маршрута, что упрощает его ссылку из других частей вашего приложения и делает ваш код более читаемым и гибким.

### Функция re_path
Хотя мы можем успешно применять функцию `path()` для определения маршрутов, она довольно ограничена по своему действию:
Например, стоит нам убрать слеш в конце: `about` и django уже не сможет сопоставить путь с запросом:
![[Pasted image 20241004122357.png]]

Ее преимущество состоит в том, что она позволяет задать адреса URL с помощью регулярных выражений:
```python
re_path(r'^about/', views.about),
```

Здесь маршрут образуются с помощью функции `re_path()`. Причем, поскольку определяется регулярное выражение, то перед строкой с шаблоном адреса URL ставится буква `r`.

В самом шаблоне адреса можно использовать различные элементы синтаксиса регулярных выражений. В частности, выражение `^about` указывает, что адрес должен начинаться с `about`. Однако он необязательно в точности должен соответствовать строке `about`, как это было в случае с функцией `path`.

Например, мы можем обратиться по любому адресу, главное чтобы он начинался с `about`, и тогда подобный запрос будет обрабатываться функцией `views.about`. Причем даже запрос [http://127.0.0.1:8000](http://127.0.0.1:8000/)[/about/hello](http://127.0.0.1:8000/about/hello) отправит запрос в представление `views.about`.
![[Pasted image 20241004122846.png]]

### Очередность маршрутов
Когда запрос приходит к приложению, то система проверяет соответствие запроса маршрутам по мере их определения: вначале сравнивается первый маршрут, если он не подходит, то сравнивается второй и так далее.

Поэтому более общие маршруты должны определяться в последнюю очередь, а более конкретные маршруты должны идти в начале. Например:

Когда запрос приходит к приложению, то система проверяет соответствие запроса маршрутам по мере их определения: вначале сравнивается первый маршрут, если он не подходит, то сравнивается второй и так далее.

Поэтому более общие маршруты должны определяться в последнюю очередь, а более конкретные маршруты должны идти в начале. Например:
```python
from django.urls import path, re_path
from blog import views
 
urlpatterns = [
    re_path(r'^about/contact/', views.contact),
    re_path(r'^about/', views.about),
    path('', views.index),
]
```
В данном случае адрес `^about/contact` представляет более конкретный маршрут по сравнению c `^about`. Поэтому он определяется в первую очередь.

Если бы было наоборот:
```python
urlpatterns = [
    path('', views.index),
    re_path(r'^about/', views.about),
    re_path(r'^about/contact/', views.contact),
]
```
то запрос по адресу `^about/contact` обрабатывался бы функцией `views.about`.

### Основные элементы синтаксиса регулярных выражений
Некоторые базовые элементы регулярных выражений, которые можно использовать для определения адресов URL:
- `**^**` начало адреса
- `**$**` конец адреса
- `**+**` 1 и более символов
- `**?**` 0 или 1 символ
- `**{n}**` n символов
- **`{n, m}`** от n до m символов
- `**.**` любой символ
- `**\d+**` одна или несколько цифр
- `**\D+**` одна или несколько НЕ цифр
- `**\w+**` один или несколько буквенных или цифровых символов а так-же символ нижнего подчёркивания `**_**`

### Определение параметров через функцию re_path
Давайте в файле `views.py` переделаем функцию `user`, а именно уберем параметры по умолчанию:
```python
#views.py
def user(request, name, age):
    return HttpResponse(f'<h2>Имя: {name}, Возраст: {age}</h2>')
```
Теперь изменим файл `urls.py`, чтобы он мог сопоставить данные функции с запросами:
```python
from django.urls import path, re_path
from blog import views

urlpatterns = [
    path('', views.index),
    path('about/', views.about, kwargs={'name': 'Tom', 'age': 38}),
    re_path(r'^contact/', views.contact),
    re_path(r'^user/(?P<name>\D+)/(?P<age>\d+)/', views.user),
]
```

### Вложенные маршруты и функция include
Функция `include()` позволяет добавить новые маршруты в django
Параметр `pattern_list` представляет набор вызовов функций `path()` и/или `re_path()`
```python
include(pattern_list)
```

Пример:
```python
product_patterns = [
    path("", views.products),
    path("new/", views.new),
    path("top/", views.top),
]

urlpatterns = [
    path("", views.index),
    path("products/", include(product_patterns)),
]
```
